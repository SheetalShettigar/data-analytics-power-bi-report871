Select dim_stores.store_type as "highest_revenue_store_type",
sum((orders_powerbi."Product Quantity" * dim_products.sale_price)) as "total_revenue"
from orders_powerbi, dim_products, dim_stores
where orders_powerbi.product_code = dim_products.product_code
and orders_powerbi."Store Code" = dim_stores."store code"
and orders_powerbi."Order Date" is not NULL
and SUBSTRING(orders_powerbi."Order Date",1,4) = '2022'
and dim_stores.country_code = 'DE'
group by dim_stores.store_type
order by total_revenue desc limit 1